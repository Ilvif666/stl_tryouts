# API для расчета стоимости 3D-печати по STL-модели

Этот проект предоставляет API на базе Node.js для расчета стоимости 3D-печати по загруженному `.stl` файлу. Приложение анализирует геометрию модели, рассчитывает объем, вес и стоимость с учетом типа пластика и заданной наценки.

---

## Особенности

- **Анализ STL файлов**: Извлечение размеров, объема и веса из загруженной модели.
- **Динамическое ценообразование**: Поддержка изменения цены за материал и наценки.
- **Поддержка различных материалов**: Настраиваемая база плотностей для разных пластиков (расположена в директории `services/json`).
- **Обработка ошибок**: Четкие сообщения об ошибках при отсутствии или неверных данных.

---

## Установка

1. Склонируйте репозиторий:
   ```bash
   git clone https://github.com/Ilvif666/stl_tryouts.git
   cd stl_tryouts
   ```

2. Установите зависимости:
   ```bash
   npm install
   ```

3. Убедитесь, что файл с плотностями и ценами материалов находится в `services/json`. Настройте плотности и поддерживаемые типы пластика при необходимости.

---

## Запуск приложения

Для запуска доступны два режима:

1. **Обычный режим**:
   ```bash
   npm start
   ```

2. **Режим разработки** (с автоматической перезагрузкой при изменениях):
   ```bash
   npm run dev
   ```

После запуска сервер будет доступен по адресу: `http://localhost:3000`.

---

## Использование API

### POST `/`

Эндпоинт для загрузки `.stl` файла и расчета стоимости.

#### Тело запроса (form-data)
| Поле        | Тип     | Описание                                       |
|-------------|---------|-----------------------------------------------|
| `file`      | File    | Файл формата `.stl` для анализа.              |
| `price`     | Number  | Цена за килограмм пластика.                   |
| `margin`    | Number  | (Опционально) Наценка в процентах.            |
| `type`      | String  | Тип пластика (например, PLA, ABS).            |

#### Пример ответа
- **200 OK**:
  ```json
  {
    "width": 81,
    "height": 45,
    "depth": 17,
    "volume": 6665,
    "weight": 8.36,
    "price": 33.44
  }
  ```
- **500 Internal Server Error**:
  Сообщение с описанием ошибки.

---

## Структура проекта

```
.
├── controllers
│   └── stlController.js   # Логика обработки файлов и расчета.
├── routes
│   └── index.js       # Определение маршрутов API.
├── services
│   ├── stlService.js      # Обработка STL-файлов и вычисления.
│   ├── weightService.js   # Расчеты веса и плотности материалов.
│   ├── priceService.js    # Расчеты стоимости.
│   └── json               # Файлы плотностей и поддерживаемых пластиков.
├── uploads                # Временное хранилище загруженных файлов.
├── bin
│   └── www                # Точка входа для сервера.
├── package.json           # Метаданные проекта и зависимости.
└── README.md              # Документация.
```

---

## Тестирование

Для тестирования API вы можете использовать инструменты, такие как Postman или cURL. Убедитесь, что `.stl` файл добавлен в запрос в формате `form-data`.

---

## Ссылка на репозиторий

Репозиторий проекта доступен по ссылке: [https://github.com/Ilvif666/stl_tryouts](https://github.com/Ilvif666/stl_tryouts).

---

## Лицензия

Проект распространяется под лицензией MIT.
